{{left_sidebar_enabled,right_sidebar_enabled=False,True}}
{{extend 'layout.html'}}

{{if not doc_exists:}} <!-- draft doc doesn't already exist ==============-->

    <br/><br/><p>Sorry, a draft of the introduction for {{=filename}}.xml does not yet exist.</p>
    <a href="{{=URL(a='grammateus3', c='docs', f='create_draft_intro', args=[filename])}}" class="btn btn-success">Create draft</a>

{{else:}} <!-- draft doc does exist already ==============================-->

    {{=H1(title, _class='document_title')}}

    <div class='draft_intro' id='editors_notes'>
        <p><b>Note for editors:</b> Although this page looks much like the published
        introductions for OCP documents, it is private. You can only view and
        edit this if you are (a) logged in, and (b) listed as an editor, assistant
        editor, or proofreader for this OCP document. If there is someone you
        would like to have access, please contact the OCP general editors.</p>

        <p>To edit a section of this introduction, simply click
        on that section (the heading or existing text) and it will become editable.
        Once you are finished editing, simply click elsewhere on the page and your
        edits will be saved.</p>

        <p>Detailed formatting, where necessary, will be done by the OCP general
        editors. Please use <i>markdown</i> notation to provide simple formatting.
        A quick reference for <i>markdown</i> notation is available <a href="http://geog.uoregon.edu/bartlein/courses/geog607/Rmd/MDquick-refcard.pdf">here</a>. If a section requires complex
        formatting, supply that section as a word-processing file to the OCP general
        editors via email.</p>
    </div>

    {{for field_title, field_content in body_fields.iteritems():}}
        {{=H2(field_title, _id=field_title, _class='section_title')}}
        {{=XML(field_content)}}
    {{pass}}

    {{block right_sidebar}}

    {{if doc_exists:}} <!-- only show sidebar if draft doc exists -->
    <div class="affix sidebar-wrapper">

        <span class="doc-version">Version {{=version}}</span>
        <a href="{{=URL('docs', 'text', args=[filename])}}" class="read-text">Read the text</a>

        <h4>Document Editor(s)</h4>
        <ul class="editor-list">
        {{for editor_id, editor_name in editors.iteritems():}}
            {{=LI(editor_name)}}
        {{pass}}
        </ul>

        {{if assistant_editors:}}
            <h4>Assistant Editor(s)</h4>
            <ul class="assistant-editor-list">
            {{for assistant_editor_id, assistant_editor_name in assistant_editors.iteritems():}}
                {{=LI(assistant_editor_name)}}
            {{pass}}
            </ul>
        {{pass}}

        {{if proofreaders:}}
            <h4>Proofreader(s)</h4>
            <ul class="proofreader-list">
            {{for proofreader_id, proofreader_name in proofreaders.iteritems():}}
                {{=LI(proofreader_name)}}
            {{pass}}
            </ul>
        {{pass}}

        <h4>Sections</h4>
        <ul id="sidebar-menu" class="nav nav-pills nav-stacked sidebar-menu">
            {{for field_title in body_fields.keys():}}
                {{=LI(A(field_title, _href='#{}'.format(field_title)))}}
            {{pass}}
            <li class="toplink"><a href="#top">Return to top</a><li>
        </ul>


        <h4>Citation Format</h4>
        {{=XML(citation_format)}}
    </div>
    {{pass}} <!-- only show sidebar content if doc exists -->

    {{end}}

{{pass}} <!-- closing else condition if document does exist ===============-->

<script>

$('table').addClass('table');

</script>
